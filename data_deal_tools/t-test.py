from scipy import stats
import matplotlib.pyplot as plt
import pandas as pd
import numpy as np

#ctbp1h=[1864.3773,1814.621,4263.9803,4451.2123,5313.6156,3449.117,3986.0643,3525.9058,2459.1317,4270.2486,2465.2606,4098.8851,3208.2298,4387.8793,3158.0544,3377.577,2517.301,3649.6085,3185.59,2934.2784,3362.5402,2509.3472,4120.0042,2088.1641,3599.5824,2718.9713,3539.12,3658.6868,2908.2987,3440.6148,4249.8309,2699.0559,3265.8273,2715.4965,2857.9088,1749.9105,7255.7669,2678.6639,4705.7593,3752.8662,2272.846,3258.3337,6200.3772,4860.9045,3742.4382,5516.8487,2938.165,3632.0245,3203.7346,4407.8902,2523.5353,7537.8961,5266.6126,3257.6741,4178.1289,4148.1551,2650.4027,4556.5526,3167.9324,3418.2582,5969.2076,3938.1472,2837.1853]
#arh=[221.5156,2528.0374,160,738.3728,540.4619,553.513,1325.4338,345.8371,1305.1219,290.0552,304.3243,400.8343,521.2714,560.0949,564.8285,583.3959,258.4779,344.6809,215.8309,734.9804,610.4331,781.7538,1293.378,644.0116,1769.6391,750.878,258.6667,750,535.3485,380.5251,2750.3676,390.2122,324.3533,2359.4455,649.286,483.9925,250.2142,595.0207,356.1728,634.5162,375.8653,1536.035,206.9204,101.6532,429.6578,103.8204,785.8383,45.7264,302.7027,544.4254,1066.5604,147.0504,159.0264,430.4539,998.4507,804.85,979.3065,82.3146,640.7369,305.8925,829.6056,347.4919,880.5748]
#ctbp1l=[2966.4646,4119.0095,5342.7439,3082.6551,3275.2609,4836,3310.4224]
#arl=[1730.8802,144.7242,226.2961,34.1386,926.0248,702.9204,175.6051]
#ctbp1h=[-1.7565,-1.8087,0.7608,0.9572,1.8619,-0.094,0.4692,-0.0135,-1.1326,0.7674,-1.1261,0.5876,-0.3467,0.8908,-0.3994,-0.1691,-1.0715,0.1163,-0.3705,-0.6341,-0.1849,-1.0799,0.6098,-1.5217,0.0638,-0.86,0.0004,0.1258,-0.6614,-0.1029,0.7459,-0.8809,-0.2863,-0.8636,-0.7142,-1.8766,3.8993,-0.9023,1.2242,0.2246,-1.328,-0.2942,2.7921,1.387,0.2137,2.0751,-0.63,0.0978,-0.3514,0.9118,-1.065,4.1952,1.8126,-0.2949,-0.2818,0.6393,-0.9319,1.0677,-0.389,-0.1264,2.5496,0.419,-0.736]
arh=[-0.7485,3.5729,-0.8637,0.2199,-0.1509,-0.1265,1.3198,-0.5155,1.2817,-0.6201,-0.5933,-0.4125,-0.1869,-0.1141,-0.1053,-0.0705,-0.6792,-0.5177,-0.7591,0.2135,-0.0198,0.3012,1.2597,0.0431,2.152,0.2433,-0.6789,0.2417,-0.1605,-0.4506,3.9895,-0.4324,-0.5558,3.2571,0.053,-0.2567,-0.6947,-0.0487,-0.4962,0.0253,-0.4593,1.7144,-0.7758,-0.973,-0.3585,-0.969,0.3088,-1.0778,-0.5964,-0.1435,0.8348,-0.888,-0.8655,-0.357,-0.1444,0.3444,0.6713,-1.0093,0.037,-0.5904,0.3908,-0.5124,0.4863]
#ctbp1l=[-0.6003,0.6087,1.8924,-0.4785,-0.5428,1.3609,-0.2395]
arl=[2.0794,-0.8923,-0.7395,-1.0995,0.2608,0.1535,-0.8345]
ctbp1l=[1814.621,5877.161,4249.8309,4178.1289,2583.6138,1946.6106,4113.2818,2934.2784,6200.3772,5364.9393,5313.6156,5266.6126,5253.082,5015.5198,4860.9045,4829.7487,4722.909,4705.7593,4556.5526,4486.0198,4407.8902,4387.8793,4349.1368,4348.1232,4306.3295,4270.2486,4148.475,4134.381,4130.3042,4120.0042,4116.4646,4098.8851,4058.372,4055.4477,3986.0643,3947.2355,3938.1472,3861.5303,3839.3226,3776.8935,3752.8662,3742.4382,3673.4837,3658.6868,3632.0245,3618.6624,3574.8159,3567.1504,3559.3294,3559.0175,3525.9058,3440.6148,3425.9336,3418.2582,3393.3984,3391.3684,3377.577,3362.5402,3336.7875,3334.5182,3314.0157,3306.1446,3265.8273,3263.7769,3262.7958,3257.6741,3239.2168,3208.2298,3185.59,3158.0544,3151.0182,2963.4938,2946.0083,2938.165,2908.2987,2895.997,2893.3432,2882.1358,2825.9364,2703.9813,2660.415,2639.2872,2523.5353,2509.3472,2419.7321,2351.5961,2241.2037,2088.1641,2017.469,1864.3773,1749.9105,1661.8094,1039.7004,7255.7669,5678.1964,4925.2737,4746.4718,4719.6215,4716.2378,4263.9803,3886.406,3840.4221,3183.4904,2965.8396,2718.9713,2699.0559,2661.8365,2563.3608,2521.7892,2487.7668,2399.5235,2272.846,2654.081,5969.2076,5516.8487,4468.3971,4451.2123,4285.9415,4236.7532,4189.4771,3891.9842,3867.0536,3823.1999,3727.1436,3714.1516,3628.5389,3618.7823,3599.5824,3562.7219,3539.12,3526.9596,3449.117,3408.9296,3289.3668,3258.3337,3167.9324,3138.3724,3133.8911,3098.2316,2837.1853,2820.9406,2771.1793,2631.5371,2530.0785,2465.2606,2381.5623,2333.7527,2259.3431,2254.1518,2250.288,1852.6957,7537.8961,6310.4081,6154.0636,5480.3962,4318.3609,4148.1551,3880.3913,3649.2256,3578.8207,3536.9454,3340.8233,3333.4995,3315.1855,3227.069,3203.7346,2876.2824,2857.9088,2796.2959,2715.4965,2537.6116,2459.1317,1709.4829,1496.3955]
ctbp1h=[6393.7452,5861.957,5842.1371,5645.4933,5575.3166,5431.4581,5420.4523,5407.8197,5393.2314,4924.0105,4754.8739,4751.9477,4674.6566,4496.4999,4450.8466,4393.9194,4351.5856,4268.0115,4234.9445,4190.0362,4183.2189,4151.8811,4146.2364,4142.8809,4119.0095,4115.9917,4043.6063,3976.3876,3910.1577,3902.455,3895.9174,3886.3057,3873.8945,3859.2535,3770.5075,3722.9073,3711.4172,3674.0078,3659.7674,3641.4568,3640.3117,3592.9441,3590.8432,3582.1551,3566.4984,3527.6634,3518.8552,3505.5066,3498.8427,3478.7011,3469.7863,3455.6138,3431.4321,3419.3595,3384.6692,3340.6479,3289.4461,3280.5397,3272.0364,3257.7204,3255.8281,3239.8121,3199.5791,3199.2117,3187.0809,3174.6814,3168.3267,3162.7626,3090.3015,3082.6316,3079.1385,3062.5842,3051.0712,2987.4198,2981.7086,2964.1954,2958.6526,2934.2362,2927.9285,2918.0292,2899.7973,2865.0019,2830.3786,2822.5153,2807.1576,2777.8695,2767.915,2750.119,2749.107,2744.6337,2716.5262,2703.1278,2674.551,2672.1048,2664.4623,2655.2239,2633.6723,2611.226,2570.9121,2562.8753,2493.6924,2450.4717,2433.3932,2283.0493,2215.3743,2203.884,2189.2285,2121.808,2100.6497,2041.6036,1966.4908,1928.8231,1674.9377,1642.4797,936.6532,6278.8298,4856.6512,4547.9808,4289.932,3863.613,3788.3343,3714.4725,3708.1394,3703.5586,3614.5838,3604.5504,3554.5633,3524.2401,3436.017,3399.3282,3369.7719,3355.7539,3304.9892,3210.1564,3093.0392,2955.9999,2572.2983,2557.4642,2488.6754,2192.0025,6054.632,4650.3523,4066.7918,3822.5874,4872.0494,4542.3462,4808.9498,4153.2905,3704.8357,3561.4694,3310.2438,3049.8528,2515.103,2264.3882,4519.5299,4013.0085,3893.7555,3708.8243,3129.7785]
# 检测数据齐性,p值远大于0.05，认为两总体具有方差齐性。
aa= stats.levene(ctbp1h, ctbp1l)
bb= stats.levene(arh, arl)
print("CTBP1数据齐性检测： ",aa)
print("AR数据齐性检测： ",bb)
cc1=stats.ttest_ind(ctbp1h, ctbp1l)
dd1=stats.ttest_ind(arh, arl)

cc=stats.ttest_ind(ctbp1h, ctbp1l,equal_var = False)
dd=stats.ttest_ind(arh, arl, equal_var = False)

# 单因素方差分析的话
kk = stats.f_oneway(ctbp1h,ctbp1l)
jj = stats.f_oneway(arh,arl)
print("CTBP1两组单因素方差分析： ",kk)
print("AR两组单因素方差分析： ",jj)
#print("CTBP1两组差异： ",cc1)
#print("AR两组差异： ",dd1)

print("CTBP1两组差异： ",cc1)
print("AR两组差异： ",dd1)

# 创建数据框方法
def plot_histom():
    ctbp1l = pd.Series(ctbp1l)
    ctbp1h = pd.Series(ctbp1h)
    arl = pd.Series(arl)
    arh = pd.Series(arh)
    kkk = {"CTBP1_low":ctbp1l,"CTBP1_high":ctbp1h,"AR_low":arl,"AR_high":arh}
    data=pd.DataFrame(kkk)
    data.boxplot()
    plt.savefig('dfall_0625.png')
    #dfa = {"CTBP1_low":ctbp1l,"CTBP1_high":ctbp1h}
    #dfb = {"AR_low":arl,"AR_high":arh}
    dfa=[ctbp1l,ctbp1h]
    df = pd.DataFrame(dfa)
    df=df.T #转置之后得到想要的结果
    df.rename(columns={0:'CTBP1_low',1:'CTBP1_high'},inplace=True)
    df.boxplot()
    plt.savefig('dfa_0625.png')
    plt.close()
    dfb=[arl,arh]
    dfs=pd.DataFrame(dfb)
    dfs=dfs.T
    dfs.rename(columns={0:'AR_low',1:'AR_high'},inplace=True)
    dfs.boxplot(notch=False)
    plt.savefig('dfb_0625.png')
    plt.close()
